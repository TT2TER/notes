# 预处理命令笔记
## 头文件：http://c.biancheng.net/view/1975.html
## #define: http://c.biancheng.net/view/1980.html
## C语言带参数的宏定义： http://c.biancheng.net/view/1982.html
## C语言带参宏定义和函数的区别： http://c.biancheng.net/view/1983.html

# 变量定义
## 全局变量
* 只能使用在编译的时候已知的值初始化
* 局部变量能隐藏全局变量
## 静态本地变量（实际上是全局变量）
* 在变量之前加static，那么只在第一次定义的时候初始化这个变量，并且在离开函数之后这个变量还在，再次进入函数的时候这个值的大小也不会改变了
* 他与全局变量在相同的内存区域
* 拥有全局的生存期和局部的作用域（static的意思是局部作用域）
## 返回指针的函数注意
* 返回本地变量的指针是危险的，函数结束后该内存就不受控制了！地址给别的东西使用了
* 返回全局变量或者静态本地变量的地址是安全的
  TODO:malloc
* 返回在函数内malloc的内存是安全的，但是容易造成问题  
* 不要使用全局变量在函数之间传递参数和结果-使用全局变量和静态本地变量的函数是线程不安全的

# 宏定义
## 编译预处理指令
* \#开头的是编译预处理指令
* \#define PI 3.14//PI是宏 在编译的时候会替换掉（原始文本替换）""在双引号中的字符串内容不会被替换，宏的后面空格等符号会被认为是宏定义的一部分
* 如果一个宏中含有其他宏，会被替换
* 宏的后面有注释的话注释不会被替换
* 宏定义换行用\\表示
* 没有值的宏，这类宏是用来做条件编译的
* 编译器中预先定义的宏
    * _LINE_ 现在的行数 %d
    * _FILE_ 文件路径
    * _DATE_ _TIME_ 日期时间

### 带参数的宏
* 像函数的宏
```c
    #define cube(x) ((x)*(x))
    --> cube(5) ((5)*(5))
```
* **一切都要有括号**
* 可以带多个参数
```c
#define MIN(a,b) (a+b)
```
* 代替函数效率高
* TODO: \# \#\# 可以产生函数
* TODO: inline

TODO: 条件预处理
TODO: error

# 大程序长什么样子
## 多个.c文件
* 新建一个项目（用Dev c++很简单）
    * 项目管理中添加两个源代码 main和其他的东西
    * 所有源代码里面源代码都编译后连接起来，编译是一个.c文件是一个编译单元，生成.o文件，build再把.o链接起来
    * 原型声明如果没有，那么编译器就猜数据类型，解决办法，头文件

## 头文件
* **在使用和定义**的时候都要包含头文件
* 把函数原型（声明就可以）放在头文件中.h结尾，在需要调用这个函数的源代码文件中#include这个头文件
* 用#include"name.h"//""是首先从当前目录找，再到系统指定目录再找
* 澄清：#include不是用来引入库的，仅仅文本替换，里面只有原型，为了检查调用时的参数是不是正确的，或者是宣称的是不是对的

## 不对外公开的函数和全局变量
在函数前加上static就只能在编译单元中使用，全局变量同理

## 声明
### 如何使用其他.c中的全局变量？
* 在.h中写
```c
extern int name;
```
这就是变量的声明
* 声明是不产生代码的东西
* 各种声明和inline函数都是声明
* 只有声明可以放在头文件里？？

## 标准头文件结构（解决声明冲突）
```c
#ifndef <标识>
#define <标识>//标识的格式一般是_UPPER_

your codes
#endif
```